<!DOCTYPE html>
<html lang="en">

<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">


    <title>Document</title>
    <style>
        /* ===================== Section Layout ===================== */

        #det {
            background: linear-gradient(to right, #667db6, #0082c8, #0082c8, #667db6);
            min-height: 100vh;
            padding: 30px 0;
            color: #fff;
            font-family: 'Poppins', sans-serif;
        }

        /* ======================= Input styling =================== */
        input.form-control {
            background-color: #222;
            border: 1px solid #444;
            color: #fff;
            border-radius: 8px;
            padding: 10px;
            font-size: 1rem;
            transition: 0.3s;
            margin-top: 20px;
        }

        input.form-control:focus {
            border-color: #00bcd4;
            box-shadow: 0 0 5px #00bcd4;
            background-color: #222;
            color: white;
        }

        /* =========================== Buttons ========================== */
        button,
        .btn {
            background: linear-gradient(135deg, navy, #00bcd4);
            color: white;
            font-weight: 600;
            border-color: #00bcd4;
            padding: 10px 25px;
            border-radius: 10px;
            transition: all 0.3s ease-in-out;
            min-width: 100px
        }

        .main-section {
            background: #141414;
        }

        button:hover,
        .btn:hover {
            transform: translateY(-3px);
        }

        button:active,
        .btn:active {
            transform: scale(0.95);
        }



        .can {

            margin: 20px 0px 20px 180px;
            width: 20%;



        }


        /* =================== Cards and Containers =================== */
        .con4 {
            background: #141414;
            border-radius: 15px;
            box-shadow: 0 0 5px #00bcd4;
            padding: 30px;
            transition: 0.3s ease-in-out;
            width: 40%;
            margin-bottom: 60px;
        }

        .con4:hover {
            transform: scale(1.01);
            box-shadow: 0 0 10px #00bcd4;
        }

        .card {
            border-radius: 15px;
            background: #141414;
            color: #fff;
        }

        .we {
            border: 2px solid #18191a;
            border-radius: 15px;
            transition: 0.3s;
            background: #141414;
        }


        /* ========================== Text Styling ======================= */
        label,
        p,
        h4,
        div {
            color: #eaeaea;
        }

        .fw-bold {
            color: hsl(0, 0%, 99%) !important;
        }

        .text-success {
            color: #22eaaa !important;
        }

        .text-danger {
            color: #ff3b3b !important;
        }

        /* ================= ACCOUNT DETAILS GLOW BOX ================= */
        #dd {
            background: #1c1c1c;
            border-radius: 20px;
            padding: 30px;
            border: 2px solid rgba(0, 255, 255, 0.5);
            box-shadow: 0 0 25px rgba(0, 255, 255, 0.4);
            max-width: 700px;
            margin: 30px auto;
            color: #fff;
            font-size: 1.1rem;
            transition: 0.4s ease-in-out;

        }

        #dd:hover {
            box-shadow: 0 0 35px rgba(0, 255, 255, 0.7);
            transform: scale(1.01);
        }

        #dd .sec {
            margin-bottom: 15px;
            line-height: 1.7;
        }

        #dd span {
            color: #00c8ff;
            font-weight: 600;

        }

        .account-title {
            background-color: #f4f4dc;
            color: #000;
            font-weight: 800;
            font-size: 1.5rem;
            text-align: center;
            padding: 10px 20px;
            border-radius: 10px;
            width: fit-content;
            margin: 0 auto 20px;
        }


        /* ======================== Welcome Card ===================== */
        .wel {
            background: linear-gradient(160deg, #222, #111);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.05);
            transition: 0.3s;
        }

        .wel:hover {
            transform: scale(1.02);
        }

        /* ======================== Responsive Layout ===================== */

        @media (max-width: 768px) {
            .main-section {
                flex-direction: column !important;
                text-align: center;
            }

            .lit {
                flex-wrap: nowrap;
                gap: 0.5rem;
                padding: 0 10px;
                /* keep inside container edges */
            }

            .con4,
            .card,
            .we {
                width: 100% !important;
                margin: 10px 0;
                padding: 30px;
            }

            #dd {
                width: 95% !important;
                /* full width look */
                max-width: none;
                padding: 25px !important;
                margin: 20px auto;
                font-size: 1rem;
                flex-wrap: wrap;
            }

            #dd .sec {
                width: 100%;
            }

            .btn {
                margin: 14px;
            }

            button {
                width: 85% !important;
                padding: 10px;
                font-size: 1.1rem;
            }

            .can {

                margin: 20px 20px 20px 100px;
                width: 20% !important;
                padding: 10px;



            }

            .d-flex.gap-4 {
                flex-direction: column !important;
                /* stack vertically */
                align-items: center;
                gap: 15px !important;
            }
        }

        /* ======================== Main Menu Section ===================== */
        .main-section:last-of-type {
            min-height: 400px;

            align-items: center;
        }

        /*=============nav==============================*/
        #nav {
            background: linear-gradient(to right, indigo, tomato);
            padding: 20px;
            border-bottom: 3px solid white;

        }

        .navbar-toggler {
            background-color: none;
            border: 2px solid wheat;
            width: 60px;
        }
    </style>


</head>

<body onload="getData()">


    <section>
        <nav id="nav" class="navbar ele  navbar-expand-lg navbar-light bg-light p-4 ">
            <div class="container-fluid  ">
                <a class="navbar-brand fw-bold  text-light " href="#">
                    <img style="border-radius: 5px;" src="logo.png" alt="" width="30" height="24"
                        class="m-1 d-inline-block align-text-top">
                    BANK OF INDIA
                </a>
                <div class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </div>
                <div class="collapse navbar-collapse justify-content-end me-3 " id="navbarNav">
                    <ul class="navbar-nav gap-4">
                        <li class="nav-item">
                            <a class="nav-link active fs-5 fw-bolder  text-light" aria-current="page"
                                href="index.html"><i class="bi bi-house-fill mx-2"></i>Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active text-light fs-5 fw-bolder  text-light" href="login.html"><i
                                    class="bi mx-2 bi-person-fill-lock"></i>Admin Login</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active fs-5 fw-bolder  text-light" href="atm.html"> <i
                                    class="bi mx-2 bi-person-fill"></i>User Login</a>
                        </li>

                    </ul>
                </div>
            </div>


        </nav>


    </section>

    <section id="det" class="p-5 ">



    </section>




    <script>
        let det = document.getElementById("det");
        let bank_name = "RAHUL",
            bank_loc = "MARATHALLI",
            bank_ifsc = "RAH1123";
        let all_customers = {};
        let coustmer = null;
        let cancelled = false;


        //===============================toggle==================================


        const toggler = document.querySelector('.navbar-toggler');
        const navMenu = document.getElementById('navbarNav');
        let count = true



        toggler.addEventListener('click', () => {
            if (count) {
                navMenu.classList.toggle('show');
                navMenu.style.marginTop = "20px"
                count = false

            }
            else {navMenu.classList.remove('show')
            count=true
        }
        })

        const sleep = (ms) => new Promise((r) => setTimeout(r, ms));

        function showMessage(text, color = "danger") {
            const msg = document.querySelector(".msg");
            if (msg) {

                msg.textContent = text;
            }
        }

        function clearScreen(cl) {
            if (cl) cl.value = "";
        }

        function cancel() {
            cancelled = true;
            showWelcome();
        }

        // =================== PIN INPUT ===================
        async function getPin() {
            return new Promise((resolve, reject) => {
                cancelled = false;
                det.innerHTML =
                    `<div  class="main-section container  d-flex gap-3 p-4 justify-content-center rounded-4 ">
      <div class="con4 d-flex flex-column gap-3 mt-5 p-4 justify-content-center">
        <div>
          <label class="form-label fw-bold  mt-5  mb-3 text-light">Enter the 4-digit PIN</label>
          <input id="passw" type="password" class="form-control" maxlength="4">
            <p id="msg" class="msg text-danger fw-bold mt-2 mx-3"></p>
        </div>
        <div class=" lit  mt-5 mx-3  d-flex justify-content-center gap-5">
          <button id="enter_pin" >Enter</button>
          <button onclick="clearScreen(passw)">Clear</button>   
        </div>
         <button class='can' onclick="cancel()">Cancel</button>
       
      </div>
      </div>
      `

                const pinBtn = document.getElementById("enter_pin");
                const pinInput = document.getElementById("passw");

                pinBtn.addEventListener('click', () => {
                    if (pinInput.value.length === 4 && !isNaN(pinInput.value))
                        resolve(Number(pinInput.value));
                    else showMessage("Enter valid 4-digit PIN");
                });

                const checkCancel = setInterval(() => {
                    if (cancelled) {
                        clearInterval(checkCancel);
                        reject("cancelled");
                    }
                }, 100);
            });
        }

        // =================== AMOUNT INPUT ===================
        async function getAmountInput() {
            return new Promise((resolve, reject) => {
                cancelled = false;
                det.innerHTML = ` <div  class="main-section container d-flex gap-3 p-4 justify-content-center rounded-4  ">
      <div class="con4 d-flex flex-column gap-3 mt-5 p-4 justify-content-center">
        <div>
          <label class="form-label fw-bold  mt-5 text-light">Enter the amount</label>
          <input id="amm" type="text" class="form-control">
          <p class="msg text-danger fw-bold mt-2 mx-3"></p>
        </div>
        <div class=" lit d-flex  justify-content-center gap-5">
          <button id="enter_amm">Enter</button>
          <button onclick="clearScreen(amm)">Clear</button>
          
        </div>
          <button class='can' onclick="cancel()">Cancel</button>
       
      </div>`

                const amtBtn = document.getElementById("enter_amm");
                const amm = document.getElementById("amm");

                amtBtn.addEventListener('click', () => {
                    const val = Number(amm.value);
                    if (val >= 100 && val <= 10000) {
                        if (val % 100 != 0) showMessage("Invalid denomination");
                        else resolve(val);
                    }
                    else showMessage("Enter valid amount (100–10000)");
                })

                const checkCancel = setInterval(() => {
                    if (cancelled) {
                        clearInterval(checkCancel);
                        reject("cancelled");
                    }
                }, 100);
            });
        }

        // =================== ACCOUNT CLASS==============================================
        function Detail(name, acc_no, adhar, mobile, password, balance, cus_no) {
            this.name = name;
            this.acc_no = acc_no;
            this.adhar_no = adhar;
            this.mobile_no = mobile;
            this.password = password;
            this.balance = balance;
            this.cus_no = cus_no;

            // ==========================================================Check Balance 
            this.checkBalance = async () => {

                let count = 3;
                while (count > 0) {

                    try {
                        const pin = await getPin();
                        if (pin === this.password) {
                            det.innerHTML = ` <div id="sec-bal" class="main-section container d-flex gap-3 p-4 justify-content-center rounded-4  ">
                                <div id="ds" class="con4 card shadow-sm p-4 text-center">
                                    <p class="fw-bold fs-5 text-light p-5 m-3">Hello ${this.name}, your available balance is ₹${this.balance}</p>
                                    <div class="d-flex justify-content-center gap-5">
                                    <button onclick="cancel()">Cancel</button>
                                    </div>
                                </div>
                                </div>`
                            break

                        } else {
                            count--;
                            showMessage(`Wrong PIN. Attempts left: ${count}`);
                            await sleep(1200);
                        }
                    } catch {
                        return cancel();
                    }
                }
                if (count == 0) {
                    showMessage("Account locked. Try after 24 hours.", "warning");
                    await sleep(1500);
                    cancel();

                }

            };

            //Deposit==============================================================================
            this.deposite = async () => {
                try {
                    const amt = await getAmountInput();



                    let count = 3;
                    while (count > 0) {
                        const pin = await getPin();
                        if (pin === this.password) {
                            this.balance += amt;
                            det.innerHTML = ` <div id="sec-dep" class="main-section container d-flex gap-3 p-4 justify-content-center  rounded-4 ">
                        <div class="con4 card shadow-sm p-4 text-center">
                        <p class="fw-bold fs-5 text-success pb-2  px-5 pt-5">Amount credited successfully</p>
                        <p class="text-light fw-bold fs-5">Hello ${this.name}, your updated balance is ₹${this.balance}</p>
                        <div class="d-flex justify-content-center p-4 gap-5">
                        <button onclick="cancel()">Cancel</button>
                        </div>
                        </div>
                        </div>`
                            return;
                        } else {
                            count--;
                            showMessage(`Wrong PIN. Attempts left: ${count}`);
                            await sleep(1200);
                        }
                    }

                    if (count == 0) {
                        showMessage("Account locked. Try after 24 hours.", "warning");
                        await sleep(1500);
                        cancel();

                    }
                } catch {
                    cancel();
                }
            };

            // ====================================Withdraw================================ 
            this.withdraw = async () => {
                try {
                    const amt = await getAmountInput();


                    if (amt > this.balance) {
                        showMessage("Insufficient Balance");
                        await sleep(1500);
                        return showMenu()
                    }

                    let count = 3;
                    while (count > 0) {
                        const pin = await getPin();
                        if (pin === this.password) {
                            this.balance -= amt;
                            det.innerHTML = ` <div id="sec-deb" class="main-section container  d-flex gap-3 p-4 justify-content-center rounded-4 ">
                            <div class="con4 card shadow-sm p-4 text-center">
                            <p class="m-3 p-5 fw-bold fs-5 text-success">Amount debited successfully</p>
                                <div class="d-flex justify-content-center gap-5">
                                <button onclick="cancel()">Cancel</button>
                            </div>
                            </div>
                                </div>`
                            return;
                        } else {
                            count--;
                            showMessage(`Wrong PIN. Attempts left: ${count}`);
                            await sleep(1200);
                        }
                    }

                    if (count == 0) {
                        showMessage("Account locked. Try after 24 hours.", "warning");
                        await sleep(1500);
                        cancel();

                    }
                } catch {
                    cancel();
                }
            };

            // ---------- Account Details ----------
            this.accountDetails = async () => {
                let count = 3;
                while (count > 0) {
                    try {
                        const pin = await getPin();
                        if (pin === this.password) {
                            det.innerHTML = ` <div id="sec-det"
      class="main-section container   rounded-3 gap-3 p-4 d-flex flex-column  justify-content-center rounded-4 ">

      <div class="account-title">Account Details</div>
      <div id="dd" class=" d-flex gap-5 rounded-3 ">
        <div class="sec  d-flex flex-column gap-3">
          <div>Name: <span>${this.name}</span></div>
          <div>Customer ID: <span>${this.coustmer_no}</span></div>
          <div>Account No: <span>${this.acc_no}</span></div>
          <div>Mobile No: <span>${this.mobile_no}</span></div>
          <div>Balance: <span>${this.balance}</span></div>
          <div>Aadhaar No: <span>${this.adhar_no}</span></div>
        </div>
        <div class="sec d-flex flex-column gap-3">
          <div>Bank Name: <span>${bank_name}</span></div>
          <div>IFSC: <span>${bank_ifsc}</span></div>
          <div>Location: <span>${bank_loc}</span></div>
        </div>
      </div>
      <div><button onclick="cancel()">Cancel</button></div>
    </div>`
                            return;
                        } else {
                            count--;
                            showMessage(`Wrong PIN. Attempts left: ${count}`);
                            await sleep(1200);
                        }
                    } catch {
                        return cancel();
                    }
                }
                if (count == 0) {
                    showMessage("Account locked. Try after 24 hours.", "warning");
                    await sleep(1500);
                    cancel();

                }
            };
        }

        // =================== SCREENS ===================
        function showWelcome() {
            det.innerHTML = `
      <div  class="main-section container bg-dark d-flex gap-3 p-4 justify-content-center rounded-4  ">
      <div class="con4 d-flex flex-column gap-3 mt-5 p-4 justify-content-center">
        <div>
          <label class="form-label fw-bold mx-5 mt-5 text-light">Welcome! Please enter your customer ID</label>
          <input id="cus_id" type="text" class="form-control">
          <p id="msg" class="msg text-danger fw-bold mt-2 mx-3"></p>
        </div>
        <div class="d-flex mt-4 justify-content-center gap-5">
          <button  onclick="getid()">Enter</button>
          <button onclick="clearScreen(cus_id)">Clear</button>
        </div>
      </div>
    </div> 

   `
        }

        function showMenu() {
            det.innerHTML = `<div id="sec-menu" class="main-section  d-flex p-4 justify-content-between rounded-3 align-items-center ">
      <div class="card we shadow-lg justify-content-evenly flex-column p-3 bg-dark">
        <button class="btn mb-3 fw-bold" onclick="fun_che()">Check Balance</button>
        <button class="btn mb-3 fw-bold" onclick="fun_with()">Withdraw</button>
        
      </div>

      <div class="wel card shadow-sm flex-grow-1 text-center text-light bg-dark mx-3">
        <h4 class="fw-bold mb-3">Welcome ${coustmer.name}!</h4>
        <p >What can I help you with today?</p>
      </div>

      <div class="card we shadow-lg justify-content-evenly flex-column p-3 bg-dark">
        <button class="btn mb-3 fw-bold" onclick="fun_dep()">Deposit</button>
        
        <button class="btn fw-bold" onclick="fun_det()">Account Details</button>
      </div>
           </div>
           `
        }
        function fun_det() {
            coustmer.accountDetails();
        }

        function fun_che() {

            coustmer.checkBalance();
        }

        function fun_dep() {

            coustmer.deposite();

        }
        function fun_with() {

            coustmer.withdraw()
        }

        // =================== DATA & LOGIN ===================
        function getData() {
            data_all = JSON.parse(localStorage.getItem("all_data"))
            all_customers = {}

            data_all.forEach((ele) => {


                all_customers[ele.coustmer_no] = new Detail(ele.name, ele.acc_no, ele.adhar_no, ele.mobile_no, ele.password, ele.bal, ele.coustmer_no)
            })
            showWelcome();
        }

        function getid() {
            const cus_id = document.getElementById("cus_id").value.trim();
            if (cus_id && all_customers[cus_id]) {
                coustmer = all_customers[cus_id];
                showMenu();
            } else showMessage("Invalid Customer ID");
        }
    </script>









</body>

</html>